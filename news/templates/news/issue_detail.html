{% extends 'base.html' %}
{% block title %}{{ issue.title }}{% endblock %}
{% block content %}
<div class="news-detail" id="newsDetail">
  {% if issue.photo %}
    <img src="{{ issue.photo.url }}" alt="{{ issue.title }}" class="img-fluid mb-4" id="detailPhoto">
  {% endif %}
  <h1>{{ issue.title }}</h1>
  <p class="text-muted">{{ issue.publication_date|date:"d F Y" }}</p>
  <div class="content">
    {{ issue.content|safe }}
  </div>
  <hr>
  <h5>Editors:</h5>
  <ul>
    {% for editor in issue.editors.all %}
      <li>{{ editor.username }}</li>
    {% endfor %}
  </ul>
  <h5>Topics:</h5>
  <ul>
    {% for topic in issue.topics.all %}
      <li>{{ topic.name }}</li>
    {% endfor %}
  </ul>

  <hr>
  <div class="reactions my-3">
    <p>
      <strong>Likes:</strong> {{ likes }}
      <strong>Dislikes:</strong> {{ dislikes }}
    </p>
    <form method="post" action="{% url 'add_reaction' issue.pk %}">
      {% csrf_token %}
      <label>
        <input type="radio" name="reaction" value="like" required> Like
      </label>
      <label>
        <input type="radio" name="reaction" value="dislike" required> Dislike
      </label>
      <button type="submit" class="btn btn-accent btn-sm">Submit Reaction</button>
    </form>
  </div>

  <hr>
  <div class="comments">
    <h4>Comments</h4>
    {% for comment in comments %}
      <div class="mb-2">
        <p>
          <strong>{{ comment.author }}</strong>
          <small class="text-muted">{{ comment.created_at|date:"d M Y H:i" }}</small>
        </p>
        <p>{{ comment.content }}</p>
      </div>
    {% empty %}
      <p>No comments yet.</p>
    {% endfor %}
  </div>

  <div class="comment-form mt-4">
    <h5>Leave a Comment</h5>
    <form method="post" action="{% url 'add_comment' issue.pk %}">
      {% csrf_token %}
      {{ comment_form.as_p }}
      <button type="submit" class="btn btn-accent">Post Comment</button>
    </form>
  </div>
</div>

<script>
  $(document).ready(function(){
    $('#newsDetail').hide().fadeIn(1000);
  });
</script>
{% endblock %}
